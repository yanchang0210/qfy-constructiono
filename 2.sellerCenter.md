# sellerCenter
## 结构
* index.html
* tpls
    * brand
    * invoiceManagement
    * purExp
    * releaseMerchant
    * selectcar
    * sellerAccount
    * sellercustomer
    * sellerInclude -- sellerLeft
    * sellerIndex
    * sellerOrders
    * shop
    * store
    * sellerMain.html
* js
    * brand
    * common
    * invoiceManagement
    * purExp
    * releaseMerchant
    * sellerAccount
    * sellerApp
    * sellercustomer
    * sellerIndex
    * sellerLeft
    * sellerOrders
    * shop
    * storeList
* css
* images
## sellerMain.html
* index.html
```html
<div ui-view></div>
```
* sellermain.html
```html
<div class="main-box">
    <div ui-view="sellerLeft"></div>
    <div ui-view="sellerRight"></div>
</div>
```
* sellerApp.js
```js
$stateProvider
    .state("sellerMain", {
        url: "/sellerMain",
        views: {
            "": {
                templateUrl: "/qfy_Angular/sellerCenter/tpls/sellerMain.html",
                controller: "sellerMain"
            },
            "sellerLeft@sellerMain": {
                templateUrl: "/qfy_Angular/sellerCenter/tpls/sellerInclude/sellersLeft.html",
                controller: "sellersLeft"
            },
            "sellerRight@sellerMain": {
                templateUrl: "/qfy_Angular/sellerCenter/tpls/sellerIndex/sellerIndex_data.html",
                controller: "sellerIndex"
            },
        },
    })
```
## sellerLeft
    > 商家中心导航,baseHttp.jsonPost获取列表数据并展示，
* baseHttp使用
    * baseHttp.jsonPost = function(url,param,back,error){}
* 通过toStateName值得判定，给当前选中的列表项添加点击样式--hover
* 动态生成列表a标签，a标签ng-click=goPage(m),m为获取的数据data.childList,通过对m.click值得判定，进行跳转
## sellerIndex_data.html
* A 用户名、照片展示
* B 公告消息
    * 公告消息展示，点击后跳转至：/sellerMain/noticeList
* C 求购信息
    * 返回的数据为 Object {code："0",data: {cnt:'15', finishList: [], responseList:[],waitList:[],message:'查询成功',result:true}}
    * 待相应 waitList
    * 已响应 responseList
    * 已下单 finishList
    * 各条信息点击跳转：/sellerMain/needOrderInfo，传参：s.id,s.responseId,s.pushId,s.state，s为上述数组中的每一项
    * 查看更多，跳转至：/sellerMain/needBybuyer,求购订单，传参：userStatus
* D 我的消息
    * 消息展示
    * 查看更多，跳转至：/sellerMain/mynews，传参：userStatus
* E 订单提醒
    * 查看更多，跳转至：/sellerMain/sellerOrders，传参：userStatus
    * 待发货、待收货、待评价的数量的获取、展示；
        * 待发货 点击跳转至：/sellerMain/sellerOrdersD?userStatus=2
        * 待收货 点击跳转至：/sellerMain/sellerOrdersDS?userStatus=2
        * 待评价 点击跳转至：/sellerMain/sellerOrdersDP?userStatus=2
        * 跳转方式：ui-sref="sellerMain.sellerOrders_dfh({userStatus:userStatus})"
    * 订单详情 ui-sref="sellerMain.readyToSend(O.orderId)，传递订单id
    * 待发货-立即发货
        * 点击弹出确认框，传入订单id、索引
        * 点击确认后，将订单id、userId传后台，页面中删除该项
    * 待收货-补录运单
        * 功能类似立即发货
    * 待评价-立即评价
        * 点击页面跳转至：/sellerMain/evaluate/170619175147641956，最后为订单id
## /sellerMain/storeLists 商品列表
### storeLists.html
* A 搜索 点击搜索，确定搜索内容信息，调用pageHttp分页方法，将内容数据传入后台，获取相应信息
* B 发布商品 点击跳转至：/sellerMain/releaseMerchantY
* C & J 多个删除 & 单个删除
* D & I 多个下架 & 单个下架  下架type传0给后台
    * 单个与多个的实现，多个进行判断，选中的加入数组中，数组长度存在，后续与单个处理一致
* E 修改库存
    * 选中一个，单个修改
    * 选中多个，批量修改
    * 双向数据绑定，弹出框确认 触发 baseHttp
* F 全选&单选 功能
* G 商品名称
    * 点击跳转至商品详情页，点击时传入商品数据的bargaining、goodsId属性
    * 通过对bargaining值得判断确定跳转的页面，bargaining=1 全车，bargaining=0 易损；
    ```js
    if (isYS == 0) {
        window.location.href = "/qfy-ysj/tapl/singleGoodsInfo/singleGoodsInfo.html?goodsID=" + goods_Id;
    } else {
        window.location.href = "/qfy_Angular//goods/singleMerchant.html?id=" + goods_Id;
    }
    ```
* H 编辑 
    ```js
    $scope.goodsEdit = function(goodsId, bargaining) {
        if (bargaining == 1) { //1全车
            $state.go('sellerMain.releaseMerchant_editor', { "goodsId": goodsId });
        } else if (bargaining == 0) { //0易损
            $state.go('sellerMain.releaseMerchantY_editor', { "goodsId": goodsId });
        }
    };
    ```
### storeunder.html
* 页面功能基本同storeList.html
## 发布商品 releaseMerchant
### 易损件-商品发布 
* A 基本信息/价格库存信息/商品描述/售后导航，锚点链接
    > $location.hash(元素ID)
* B 基本信息三级联动显示，点击后下方展示信息
    * 第三级联动点击后，向/services/dubooGoods/selectSpecifications.do请求数据，返回需要添加的属性 $scope.specificArr = data.listData
    * 通过返回数据的required判断是否必填
    * assonrtmentValue.length 值=0，元素为输入框，值>0，元素为下拉菜单
* C 申请新品牌
    * 双向数据绑定，将新品牌名传入后台，验证是否重复
    * 提交，将数据传递后台，展示返回的数据
* D 品牌
    * 页面加载后，调取品牌接口，展示品牌
    * 首字母点击后调取品牌接口，展示对应字母品牌信息
    * 品牌点击后，下方进行展示
* 配件种类
    * 选中蓝色样式效果
* 发票
    * 功能同配件种类
* 退换货承诺
* 商品描述 百度富文本 UM  元素id：myeditor
* 保存
    * 第一步进行各数据验证
    * 第二步获取数据
    * 第三步传后台
### 易损件-商品编辑
### 全车件-商品发布
* 适用车型
    * 通用件/选择车型
    * 选择车型选中后，出现选择车型按钮，点击后弹出选择车型弹出框，选择品牌/选择厂家/选择车系/选择年份四级联动
### 全车件-商品编辑
## 交易管理 sellerOrders
### 收到的求购 /sellerMain/needBybuyer?userStatus=2
* 导航
    * 全部/待响应/已响应/已达成订单 切换
* 搜索功能
    * pageHttp
    * 判断下方定向需求/普通需求是否选定，值添加入参数
        * 定向需求为1，普通需求为2
    ```js
    <!-- 传入后台参数 -->
    "id": userId,
    "page": p,
    "pageSize": s,
    "state": -1,    <!-- 全部订单 -->
    "title": $scope.needByBuyerParams.title ? $scope.needByBuyerParams.title : "",   <!-- 查询的input值 -->
    "subUserId": subUserId
    ```
* 全部
    * 全部订单/待响应/已响应/已成交  使用ng-options显示，点击后getData函数调取对应数据展示--下拉框筛选
    ```js
    <!-- 对应关系 -->
    $scope.stus = [ /*必须按照顺序排放*/
        { "state": "-1", "val": "全部订单" },
        { "state": "0", "val": "待响应" },
        { "state": "1", "val": "已响应" },
        { "state": "2", "val": "已成交" }
    ];
    ```
 * 待响应、已响应、已成交页面功能同全部
 * 查询详情
    * 点击跳转至：/sellerMain/needOrderInfo  
    ```js
    <!-- 传参 -->
    var Id = {};
    Id.needId = needId;
    Id.responseId = responseId;
    Id.pushId = pushId;
    Id.stateVal = $scope.state(stateVal).state;
    ``` 
* 订单详情页面
    * angular.fromJson($stateParams.Id)  获取url传入的参数
    ```js
    {needId: "40441", responseId: "35445", pushId: "208765", stateVal: "已成交"}
    ```
    * top部分 展示信息，点击查看电话功能
        * 待响应订单： top部分有  报价  删除功能
        * 已响应订单： top部分有  修改报价功能
        * 已达成订单： top部分无功能
    * 图片展示 
    * 附件 excel表格预览

    * imgPug






























```js
// str转json
function strToJson(str) {
    var json = eval('(' + str + ')');
    return json;
}
```